# CleanAI

## Windows CI (WinUI в приоритете)

В репозитории используется `.github/workflows/build.yml` со схемой:

1. ставятся зависимости через `vcpkg`;
2. `cmake` пытается собрать полноценный WinUI-вариант;
3. если на раннере нет `Microsoft.WindowsAppSDK`, CMake автоматически уходит в headless-режим;
4. `msbuild` собирает `Release x64`;
5. CI определяет, что именно собралось: `winui` или `headless`.

### Что это значит

- Для обычных проверок (push/PR) пайплайн не падает: даже при проблемах с WinUI собирается технический headless-вариант.
- Для тега релиза `v*` действует жёсткое правило: если получился только headless, job завершается ошибкой и **пользовательский релиз не публикуется**.
- Когда WinUI доступен, CI публикует `CleanAI-win64.zip` с полноценным приложением.

### На человеческом языке: «это как?»

Представьте доставку:

- в будни курьер может привезти учебный макет (чтобы проверка процесса не ломалась);
- но на официальную витрину магазина такой макет выкладывать запрещено.

То есть в релиз для людей попадёт только нормальное приложение с интерфейсом. Если его не удалось собрать — релиз честно не выходит.

### Что публикует CI


- `CleanAI.CoreLogicTests.exe` — это служебный тест, он запускается, печатает проверки и закрывается. Это нормально, это не пользовательское приложение.
- Если собрался WinUI: `CleanAI.exe` и `CleanAI-win64.zip`.
- Если произошёл fallback: только `CleanAI-headless-exe` (диагностический артефакт, не для пользователей).
- Для тегов `v*`: в GitHub Release публикуется только `CleanAI-win64.zip` и только при WinUI-сборке.
- Всегда: `build-debug-logs` для диагностики.

### Как получить пользовательскую версию

Скачивайте для пользователей только `CleanAI-win64.zip`, распакуйте архив полностью и запустите `Start-CleanAI.bat` (или `CleanAI.exe`). Не берите `CleanAI-headless-exe` — это техническая заглушка для диагностики CI. И не запускайте `CleanAI.CoreLogicTests.exe`: это служебная проверка, после неё окно закрывается — так и задумано.


### Где именно запускать «полную» программу

Вот прямо по шагам без магии:

1. Откройте Actions/Artifacts (или GitHub Release для тега `v*`).
2. Скачайте архив **`CleanAI-win64.zip`** (в Actions он лежит как артефакт **`CleanAI-win64-full-app`**).
3. Распакуйте архив в обычную папку (не запускайте прямо из zip).
4. Откройте папку `CleanAI-win64` и запустите **`Start-CleanAI.bat`** (или `CleanAI.exe`).

Если запускается `CleanAI.CoreLogicTests.exe`, значит открыт служебный тест, а не сама программа.

> Если в техническом headless-окне видите «кракозябры», обновите артефакт до свежей сборки: в проекте включена UTF-8 компиляция для корректного русского текста.

